\documentclass[svgnames]{report}
\usepackage{wordle}
\usepackage{manfnt}
\usepackage{enumitem}
\setlist[description]{font=\sffamily\bfseries\color{ForestGreen},labelwidth=\textwidth}
\usepackage{booktabs}
\usepackage[a4paper,margin=18mm]{geometry}
\synctex=1
\parindent=0pt
\parskip=2mm

\usepackage{cmap} % fix search and cut-and-paste in Acrobat
\setcounter{secnumdepth}{0}

\usepackage{listings}\lstset{language=[LaTeX]TeX,framerule=2pt}
\lstset{language=[LaTeX]TeX,
        texcsstyle=*\bfseries\color{Peru},
        backgroundcolor=\color{Ivory},
        numbers=none,
        breaklines=true,
        keywordstyle=\color{Sienna},
        commentstyle=\color{BurlyWood},
        tabsize=2,
        morekeywords={Wordle,wordle},
        resetmargins=true,
}
% hyperref links to ctan
\newcommand\ctan[1]{\href{https://www.ctan.org/pkg/#1}{\texttt{#1}}}

\newcommand\Section[1]{\subsection{\textcolor{DarkGreen}{#1}}}

\NewDocumentCommand\option{ om }{%
  \medskip\textbf{\textcolor{Crimson}{#2}}%
  \IfNoValueF{#1}{ (default: \textcolor{DarkRed}{#1})}%
  \index{#2}%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{imakeidx}
\indexsetup{level=\section*, toclevel=section, noclearpage}
\makeindex[intoc,columns=3]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage[skins,listings]{tcolorbox}
\usetikzlibrary{backgrounds} % for tikz={framed,...}

\DeclareTotalTCBox\keyword{ O{} v }{
  fontupper=\sffamily,
  nobeforeafter,
  skin=tile,
  verbatim,
  on line,
  tcbox raise base,
  top=0pt,bottom=0pt,left=0mm,right=0mm,
  colback=OldLace,
  colupper=ForestGreen,
  #1}
{#2}

\lstdefinestyle{tikz}{style=tcblatex,
  classoffset=0,
  texcsstyle=*\color{DarkGoldenrod},%
  deletetexcs={begin, end},
  moretexcs={,%
    node,
    draw,
    true,
    false
  },%
  classoffset=1,
  keywordstyle=\color{ForestGreen},%
  morekeywords={wordle},
  classoffset=2,
  keywordstyle=\color{Crimson},%
  morekeywords={
    border,
    case,
    correct,
    font,
    letterstyle,
    lower,
    name,
    natural
    placed,
    rows,
    sensitive,
    separation,
    shape,
    size,
    strict,
    text,
    tikz,
    empty,
    upper,
    wrong,
  }
}

\DeclareTCBListing{example}{ !O{} }{%
  skin=bicolor,
  colframe=MediumSeaGreen,
  colbacklower=OldLace,
  colback=LawnGreen!20,
  lefthand width=50mm,
  listing style=tikz,
  sidebyside,
  sidebyside align=center,
  sidebyside gap=4mm,
  text and listing,
  text outside listing,
  boxsep = 0pt,
  #1
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\makeatletter
\author{Andrew Mathas}
\usepackage{tikz}
\usetikzlibrary{shadows.blur}
\tikzset{shadowed/.style={blur shadow={shadow blur steps=5},
                          bottom color=ForestGreen!30,
                          draw=MediumSeaGreen!70,
                          shade,
                          font=\normalfont\Huge\bfseries\scshape,
                          rounded corners=8pt,
                          top color=SeaGreen,
      },
      boxes/.style={draw=SeaGreen,
                    fill=Cornsilk,
                    font=\sffamily\small,
                    inner sep=5pt,
                    rectangle,
                    rounded corners=8pt,
                    text=DarkGreen,
     }
}
\newcommand\Wordle{%
  \begin{tikzpicture}[remember picture,overlay]
      \node[yshift=-3cm] at (current page.north west)
        {\begin{tikzpicture}[remember picture, overlay]
          \draw[shadowed](30mm,0) rectangle node[white]{Wordle} (\paperwidth-30mm,16mm);
          \node[anchor=west,boxes] at (4cm,0cm) {\@author};
          \node[anchor=east,boxes] at (\paperwidth-4cm,0) {Version \wordle@version};
         \end{tikzpicture}
        };
   \end{tikzpicture}
   \vspace*{20mm}
}

\def\@oddfoot{\textsc{Wordle} -- \wordle@version\hfill\thepage}

\usepackage[colorlinks=true,linkcolor=blue,urlcolor=MediumBlue]{hyperref}
\hypersetup{
  pdfcreator={ Generated by pdfLaTeX },
  pdfinfo={
    Author  ={ Andrew Mathas },
    Keywords={ wordle },
    License ={ LaTeX Project Public License v1.3c or later },
    Subject ={ LaTeXing Wordle puzzles },
    Title   ={ Wordle - \wordle@version }
  },
}
\makeatother

\begin{document}

  \Wordle

  This package provides a stupidly feature-rich way of creating
  \keyword{Wordle} puzzles in \LaTeX, which
  \href{https://en.wikipedia.org/wiki/Wordle}{Wikipedia} describes as a
  hugely popular web-based word game created and developed by Welsh
  software engineer Josh Wardle. This package is an enhanced version of
  my solution to a question asked by \textcolor{FireBrick}{valerio\_new} on
  \href{https://tex.stackexchange.com/questions/659860/wordle-like-colored-letter-boxes-in-latex/660056#660056}{tex.stackexchange.com}.


  This package provides the \keyword{wordle} environment, which uses the
  syntax:

  \begin{tcblisting}{
    listing only,
    skin=bicolor,
    colframe=MediumSeaGreen,
    colbacklower=OldLace,
    colback=LawnGreen!20,
    listing style=tikz,
    boxsep = 0pt,
  }
        % \usepackage{wordle}
        \begin{wordle}[wordle options]{solution}[optional tikz commands]
          guess1 guess2 ...
        \end{wordle}
  \end{tcblisting}

  The words in the puzzle can be entered on a single, or on separate
  lines.  Here is an explicit example:

  \begin{example}
    \begin{wordle}{ANVIL}
      CRANE
      NATAL
      ANVIL
    \end{wordle}
  \end{example}

  As in the online puzzles, the \keyword{wordle} environment
  automatically colours the letter tiles
  \keyword[colback=ForestGreen!80!LimeGreen,colupper=White]{green}
  when the letter is in the same position as the solution and as
  \keyword[colback=Gold!70!DarkGoldenrod,colupper=White]{gold} when
  the letter appears in the solution but is in the wrong position. As
  described below, these colours can be changed to suit your tastes.

  The number of letters in the puzzle is determined by the solution,
  being constrained only by the page width.

  \begin{example}
    \begin{wordle}[rows=4]{orange}
       normal
       orders
       orange
    \end{wordle}
  \end{example}

  The letters in the puzzle can be entered in upper case, lower case, or
  mixed case. By default, the case of the letters is ignored when
  determining the colours the letter tiles.  There is an array of
  different options that allow you to  change the colours, fonts, change
  the case sensitivity, and add extra rows to the puzzle, disable
  special formatting of the \textit{letter tiles}. More precisely,
  the \keyword|wordle| environment can be customised using the
  following options:
  \begin{quote}\sffamily\color{Crimson}
    border,
    correct,
    font,
    letterstyle,
    placed,
    separation,
    shape,
    size,
    text,
    wrong,
    name,
    tikz,
    strict,
    rows,
    empty,
    case~sensitive,
    lower case,
    natural case,
    upper case,
  \end{quote}
  These options are given as a comma separated list key-value pairs.
  They can be set locally, using the optional argument of the
  \keyword|wordle| environment, or they can be set globally (more
  accurately, in the current \LaTeX\ group) using the
  \keyword{\WordleSetup} command \index{\textbackslash WordleSetup}, or
  as global package options, via \keyword{\usepackage[options]{wordle}}.
  The order of the options does not matter, except that later options
  take precedence over earlier ones, with the exception of \option{tikz}
  and \option{letterstyle} are always applied last.

  The \keyword{wordle} puzzles are drawn using \ctan{TikZ}, with each
  letter in the puzzle sitting inside a \ctan{TikZ} node. Many of the
  options control the settings of these nodes. Several of these options
  set the colours used by \keyword{wordle}. Colour names use the
  \keyword{svgnames} names provided by the \ctan{xcolor} package.

  The descriptions of the options below are grouped according to their
  function.

  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \Section{Options controlling the style of the letter tiles}

  The letter tiles in a \keyword{wordle} environment are typeset insude
  a \ctan{TikZ} \keyword{\node}. The options below control the different
  style settings of these nodes.

  \option[white]{border}

  Sets the border colour of the \keyword{wordle} letter tiles.

  \begin{example}
    \begin{wordle}[border=red]{ANVIL}
      CRANE
      NATAL
      ANVIL
    \end{wordle}
  \end{example}

  \option[ForestGreen!80!LimeGreen]{correct}

  Sets the tile colour of the correct \keyword{wordle} letter tiles,
  which are the letters in the same positions as letters in the solution.

  \begin{example}
    \begin{wordle}[correct=LightSkyBlue]{cellar}
      pounds
      tailer
      cellar
    \end{wordle}
  \end{example}

  \option[\textbackslash bfseries]{font}

  Sets the font used by \keyword{wordle} letters. Any valid sequence of
  \LaTeX\ font commands can be used.

  \begin{example}
    \begin{wordle}[font=\large\sffamily]{ANVIL}
      CRANE
      NATAL
      ANVIL
    \end{wordle}
  \end{example}

  \option[Gold!70!DarkGoldenrod]{placed}

  Sets the tile colour of the \textit{placed} \keyword{wordle} letter tiles,
  which are those letters that appear in the solution but which are
  currently in the wrong position.

  \begin{example}
    \begin{wordle}[placed=Orange]{ANVIL}
      CRANE
      NATAL
      ANVIL
    \end{wordle}
  \end{example}

  \option[1mm]{separation}

  Sets the separation distance between the \keyword{wordle} letter
  tiles.

  \begin{example}
    \begin{wordle}[separation=2mm]{ANVIL}
      CRANE
      NATAL
      ANVIL
    \end{wordle}
  \end{example}

  \option[rectangle]{shape}

  Specifies the \textit{shape} of the \keyword{wordle} letter. The default tile
  \option{shape} is a \textsf{rectangle} (more precisely, a square), but the
  \ctan{TikZ} node shapes of \textsf{circle} and \textsf{coordinate} can
  also be used; see section 17.2 of the \ctan{TikZ} manual.

  \begin{example}
    \begin{wordle}[shape=circle]{LADLE}
       FLAIL LAPEL * LADLE LOVER
    \end{wordle}
  \end{example}

  \option[7.0mm]{size}

  The \option{size} option sets the size of the \keyword{wordle}
  letter tiles.  If you change the size  of the tiles, then you will
  almost certainly want to change font size font as well, which you can
  do using the \option{font} option:

  \begin{example}
    \begin{wordle}[size=10mm, font=\huge\bfseries]{LADLE}
       FLAIL LAPEL * LADLE
    \end{wordle}
  \end{example}

  \option[white]{text}

  Sets the colour of the letters in the \keyword{wordle} puzzle.

  \begin{example}
    \begin{wordle}[text=DarkSlateGrey]{LADLE}
       FLAIL LAPEL LASER
    \end{wordle}
  \end{example}

  \option[Gray]{wrong}

  Sets the tile colour of the \keyword{wordle} letter tiles for letters
  that do nbot appear in the solution.

  \begin{example}
    \begin{wordle}[wrong=red]{LADLE}
       FLAIL LAPEL LASER
    \end{wordle}
  \end{example}

  \option[--]{letterstyle}

  A comma-separated list of \ctan{Tikz} node keys that are appended to
  the style of the \ctan{TikZ} node that contains each of the
  \keyword{wordle} letters.  Most of the options given above can also be
  set using the \option{letterstyle} option.

  With most of the \keyword{wordle} options, the latter options take
  precedence, however, the \option{letterstyle} option is applied last,
  so it overrides any competing options. When using the
  \option{letterstyle} option, you should be careful not to break the
  special formatting of letters provided by the \keyword{wordle}
  environment.\par

  \begin{example}
    \begin{wordle}[letterstyle={rounded corners}]{ANVIL}
      CRANE
      NATAL
      ANVIL
    \end{wordle}
  \end{example}

  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \Section{Extra rows and columns}

  By default, the number of letters in each word in the \keyword{wordle}
  is assumed to the same as the of letters in the solutions, and the
  number of rows in the puzzle is number of words given in the
  environment. The options below allow give more control over the number
  of rows and columns in the puzzle.

  \option[false]{strict}

  By default, the \keyword{wordle} environment does not check to make
  sure that each word in the puzzle has the same length as the solution,
  so missing and extra letters receive no special processing.

  \begin{example}
    \begin{wordle}{CRAZE}
      GRAIL
      TRACK
      CRAMPS
      CRAM
      CRABS
    \end{wordle}
  \end{example}

  The \option{strict} option enforces the word length in the puzzle by
  marking missing letters as incorrect and striking out extra letters.

  \begin{example}
    \begin{wordle}[strict]{CRAZE}
      GRAIL
      TRACK
      CRAMPS
      CRAM
      CRABS
    \end{wordle}
  \end{example}

  By default, a \keyword{wordle} environment displays the words
  in the puzzle environment with one word per row. You can add extra
  (blank) rows to the puzzle with the \option{rows} option.

  \option[--]{rows}

  \begin{example}
    \begin{wordle}[rows=4]{ANVIL}
      CRANE
      NATAL
      ANVIL
    \end{wordle}
  \end{example}

  The \option{rows} option only adds extra rows to the puzzle if they are
  needed. It does not prevent rows from appearing.

  \begin{example}
    \begin{wordle}[rows=2]{ANVIL}
      CRANE
      NATAL
      ANVIL
    \end{wordle}
  \end{example}


  \option[OldLace]{empty}

  Sets the tile colour of the \textit{\empty} tiles in the puzzle.

  \begin{example}
    \begin{wordle}[rows=5, empty=AliceBlue]{ANVIL}
      CRANE
      NATAL
      ANVIL
    \end{wordle}
  \end{example}

  \option{*}

  You can disable the automatic colouring of future letter tiles by
  inserting an asterisk,~\option{*}, as a \textit{word} in the puzzle.

  \begin{example}
    \begin{wordle}{ANVIL}
      CRANE
      NATAL
      *
      ANNUL
      ANVIL
    \end{wordle}
  \end{example}


  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \Section{Case sensitivity}
  \index{case~sensitive}
  \index{case~sensitive!lower case}
  \index{case~sensitive!natural case}
  \index{case~sensitive!upper case}

  By default, the letters are printed in upper and lower case, exactly
  as typed, and the letter comparisons are not case sensitive.

  \option[false]{case~sensitive}

  By default the \keyword{wordle} puzzles are not case sensitive, but
  you can make them case sensitive using this option. Note that
  \keyword{case sensitive} is the same as \keyword{case sensitive=true}
  (and the default option is the same as
  \keyword{case sensitive=false}).

  \begin{example}
    \begin{wordle}{youth}
      North
      South
      Youth
    \end{wordle}
  \end{example}

  Here is a more (case) sensitive version of this puzzle.

  \begin{example}
    \begin{wordle}[case sensitive=true]{youth}
      North
      South
      Youth
    \end{wordle}
  \end{example}

  As this puzzle is case sensitive, the \keyword{Y} on the last line
  is not correct because it does not match the \keyword{y} in the
  solution.

  The \option{upper case} and \option{lower case} options force all
  letters in the puzzle to be in upper or upper case, respectively.

  \begin{example}
    \begin{wordle}[lower case]{YOUTH}
      North
      South
      Youth
    \end{wordle}
  \end{example}

  \begin{example}
    \begin{wordle}[upper case]{youth}
      North
      South
      Youth
    \end{wordle}
  \end{example}

  As these examples show, both of these options disable the case sensitivity of the tests:

  To balance these two options, the \option{natural case} option makes
  the \keyword{wordle} environment respect the case of the letters as
  typed into the environment.

  \begin{example}
    \begin{wordle}[natural case]{youth}
      North
      South
      youth
    \end{wordle}
  \end{example}

  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \Section{Adding \ctan{TikZ} code}

  The \keyword{wordle} environment is a fancy wrapper around a
  \keyword{tikzpicture} environment, with some code under the hood
  to automatically colour of the letter tiles. The options in this
  section describe how to access the underlying \ctan{TikZ} layer.

  \option[--]{tikz}

  The \option{tikz} option passes style commands to the underlying
  \keyword{tikzpicture} environment. The \option{tikz} option is almost
  the same as using a \keyword{\tikzset{...}} command before the
  \keyword{wordle} environment except that it is applied \textit{after}
  the style commands above and \textit{before} \option{letterstyle} is
  applied.

  \begin{example}
    % \usetikzlibrary{backgrounds}
    \begin{wordle}[
        tikz={framed,
              background rectangle/.style={
                double,ultra thick,
                draw=SteelBlue,
              }
        }]{youth}
      North
      South
      youth
    \end{wordle}
  \end{example}

  As the example indicates, it is advisable to enclose complicated
  \ctan{TikZ} settings inside braces.

  In addition to passing \ctan{TikZ} style settings to the underlying
  \keyword{tikzpicture} environment, it is possible to add \ctan{TikZ}
  commands to a \keyword{wordle} environment. The letter tiles in  a
  \keyword{wordle} environment are \ctan{TikZ} nodes, which are
  automatically given names of the form
  \textsf{W-$\mathsf{r}$-$\mathsf{c}$}, for the tile in row~$\mathsf{r}$
  and column~$\mathsf{c}$. The \textit{prefix} of the node name can be
  changed using the \option{name} option.

  The second optional argument to the \keyword{wordle} environment can
  be used to add further \ctan{TikZ} commands to the puzzle. As the
  \option{tikz} option, it is advisable to enclose complicated
  \ctan{TikZ} commands inside braces.

  \option[W]{name}

  \begin{example}
    \begin{wordle}[name=M,
          tikz={arr/.style={Fuchsia,ultra thick,->}}]{MACAW}
        [{
          \draw[arr](M-1-3.south)--(M-3-2.north)--(M-4-2.north);
          \draw[arr](M-1-1.south)--(M-3-5.north)--(M-4-5.north);
        }]
      CRANE HOTLY BASIC MACAW
    \end{wordle}
  \end{example}

  In practice, I am not sure that anyone will find a real use for this!

  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \Section{The package code}

  The \keyword{wordle} package is a \LaTeX3 package. There are many
  comments in the code explaining how the code works. The automatic
  colouring of the letter tiles is a fun exercise in \LaTeX3
  programming, which was motivated by a
  \href{https://tex.stackexchange.com/questions/659860/wordle-like-colored-letter-boxes-in-latex/660056#660056}{tex.stackexchange.com} post.

  Bug reports and feature requests can be made on \href{https://github.com/AndrewMathas/Wordle}{github}.

  \makeatletter
  Version: \wordle@version
  \makeatother

  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \printindex

\end{document}
